<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What is Sigmoid? - Logistic Regression Interactive | How LLM Works</title>
    <meta name="description" content="Interactive visualization of the Sigmoid function in Logistic Regression. Switch between mathematical notations (School, Stats, ML, Linear Algebra) and see how parameters shape the probability curve.">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --bg-color: #fafafa;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
            --accent-color: #667eea; /* Matching the previous sigmoid theme slightly but keeping style consistent */
            --accent-hover: #5a6fd6;
            --secondary-color: #7f8c8d;
            --border-radius: 12px;
            --shadow: 0 4px 20px rgba(0,0,0,0.06);
            --font-main: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 380px 1fr;
            height: 100vh;
        }

        /* Sidebar Controls */
        .sidebar {
            background: var(--card-bg);
            padding: 25px;
            box-shadow: 4px 0 20px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
            z-index: 10;
        }

        h1 {
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0 0 5px 0;
            color: var(--text-color);
        }

        .subtitle {
            font-size: 0.9rem;
            color: var(--secondary-color);
            margin: 0 0 15px 0;
            line-height: 1.4;
        }

        /* Notations Tab Switcher inside Sidebar */
        .notation-tabs {
            display: flex;
            gap: 5px;
            background: #f1f3f5;
            padding: 4px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .tab-btn {
            flex: 1;
            padding: 8px 4px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            color: #666;
            border-radius: 6px;
            transition: all 0.2s ease;
            text-align: center;
        }

        .tab-btn.active {
            background: white;
            color: var(--accent-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* Formula Box */
        .stat-box {
            background: #ecf0f1;
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            border-left: 4px solid var(--accent-color);
        }

        .main-formula {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        .z-formula {
            font-size: 1.1rem;
            color: var(--secondary-color);
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #ccc;
        }

        .notation-desc {
            font-size: 0.8rem;
            color: #555;
            margin-top: 10px;
            line-height: 1.5;
            text-align: left;
        }

        /* Controls */
        .control-panel {
            background: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid #eee;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .control-group label {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }

        .value-badge {
            background: var(--accent-color);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-family: monospace;
        }

        input[type="range"] {
            width: 100%;
            cursor: pointer;
            accent-color: var(--accent-color);
        }

        /* Content Area */
        .content {
            padding: 30px;
            display: grid;
            grid-template-rows: auto 1fr;
            gap: 30px;
            overflow-y: auto;
            background-color: #f0f2f5;
        }

        .viz-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            display: flex;
            flex-direction: column;
            min-height: 400px;
        }

        .card-header {
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #2c3e50;
        }

        #sigmoidPlot {
            flex: 1;
            width: 100%;
            min-height: 400px;
        }

        .explanation-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .info-card {
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .info-card h3 {
            margin-top: 0;
            font-size: 1rem;
            color: var(--accent-color);
        }

        .info-card p {
            font-size: 0.9rem;
            line-height: 1.6;
            color: #555;
        }

        /* Mobile Responsive */
        @media (max-width: 900px) {
            .main-layout { grid-template-columns: 1fr; grid-template-rows: auto 1fr; }
            .sidebar { height: auto; max-height: 45vh; }
            .content { padding: 15px; gap: 15px; }
            .explanation-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div class="main-layout">
    <!-- Sidebar -->
    <div class="sidebar">
        <div>
            <h1>Logistic Regression</h1>
            <div class="subtitle">Understanding the Sigmoid Function</div>
        </div>

        <!-- Notation Switcher -->
        <div class="notation-tabs">
            <button class="tab-btn active" onclick="setMode('school')">School</button>
            <button class="tab-btn" onclick="setMode('stats')">Stats</button>
            <button class="tab-btn" onclick="setMode('ml')">ML / NN</button>
            <button class="tab-btn" onclick="setMode('linalg')">LinAlg</button>
        </div>

        <!-- Formula Display -->
        <div class="stat-box">
            <div class="main-formula">
                $$ \sigma(z) = \frac{1}{1 + e^{-z}} $$
            </div>
            <div id="zFormulaContainer" class="z-formula">
                $$ z = \beta_0 + \beta_1 x $$
            </div>
            <div id="descContainer" class="notation-desc">
                <strong>Simple & Intuitive.</strong> One input, one line. We see how changing $x$ affects the probability directly.
            </div>
        </div>

        <!-- Controls -->
        <div class="control-panel">
            <div id="sliders-container">
                <!-- Sliders injected by JS -->
            </div>
            
            <div class="control-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
                <label>
                    Input Value ($x$)
                    <span class="value-badge" id="val-xPoint">0.0</span>
                </label>
                <input type="range" id="xPointSlider" min="-10" max="10" step="0.1" value="0">
            </div>
        </div>
        
        <div style="font-size: 0.8rem; color: #999; line-height: 1.5;">
            <strong>Pro Tip:</strong><br>
            Notice that regardless of the notation ($w$, $\beta$, vectors), the <strong>Sigmoid</strong> always does the same thing: squashes any number into a probability [0, 1].
        </div>
    </div>

    <!-- Main Content -->
    <div class="content">
        <!-- Visualization -->
        <div class="viz-card">
            <div class="card-header">
                <div class="card-title">Sigmoid Curve $\sigma(z)$</div>
                <div style="font-family: monospace; color: var(--accent-color); font-weight: bold;">
                    P(y=1) = <span id="probDisplay">0.50</span>
                </div>
            </div>
            <div id="sigmoidPlot"></div>
        </div>

        <!-- Explanations -->
        <div class="explanation-grid">
            <div class="info-card">
                <h3>Why Sigmoid?</h3>
                <p>
                    Linear lines ($z$) go from $-\infty$ to $+\infty$. This is bad for probabilities.
                    We need a way to force values between <strong>0 and 1</strong>.
                </p>
                <p>
                    The Sigmoid function acts as a "squashing" gate. Large positive numbers become $\approx 1$. Large negative numbers become $\approx 0$. Zero becomes exactly $0.5$.
                </p>
            </div>
            <div class="info-card">
                <h3>The "Decision Boundary"</h3>
                <p>
                    The model is "unsure" (50% probability) exactly when $z = 0$.
                </p>
                <p>
                    Check the current values:
                    <br>
                    $z = $ <strong id="zValDisplay">0.00</strong>
                    <br>
                    $\sigma(z) = $ <strong id="sigmaValDisplay">0.50</strong>
                </p>
                <p style="font-size: 0.85rem; color: #888;">
                    If $z > 0$, we predict Class 1.<br>
                    If $z < 0$, we predict Class 0.
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    // --- State Management ---
    const state = {
        mode: 'school',
        w0: 0,   // Bias / Intercept
        w1: 1,   // Weight 1 / Slope
        w2: 0.5, // Weight 2 (hidden/contextual)
        xPoint: 0 // Current x position
    };

    // --- Configuration for Modes ---
    const modes = {
        school: {
            label: 'School',
            formula: '$$ z = \\beta_0 + \\beta_1 x $$',
            desc: '<strong>Интуиция:</strong> Одна фича, одна прямая. Самый простой вид.',
            sliders: [
                { key: 'w0', label: 'β₀', min: -5, max: 5, step: 0.1 },
                { key: 'w1', label: 'β₁', min: -5, max: 5, step: 0.1 }
            ]
        },
        stats: {
            label: 'Stats',
            formula: '$$ z = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\dots $$',
            desc: '<strong>Регрессия:</strong> Несколько фич, каждая со своим весом.',
            sliders: [
                { key: 'w0', label: 'β₀', min: -5, max: 5, step: 0.1 },
                { key: 'w1', label: 'β₁', min: -5, max: 5, step: 0.1 },
                { key: 'w2', label: 'β₂', min: -5, max: 5, step: 0.1 }
            ]
        },
        ml: {
            label: 'ML',
            formula: '$$ z = w_1 x_1 + w_2 x_2 + \\dots + w_p x_p + b $$',
            desc: '<strong>ML / Нейросети:</strong> То же самое, просто другие буквы.',
            sliders: [
                { key: 'w0', label: 'b', min: -5, max: 5, step: 0.1 },
                { key: 'w1', label: 'w₁', min: -5, max: 5, step: 0.1 },
                { key: 'w2', label: 'w₂', min: -5, max: 5, step: 0.1 }
            ]
        },
        linalg: {
            label: 'LinAlg',
            formula: '$$ z = X\\mathbf{w} + b $$',
            desc: '<strong>Векторная форма:</strong> Удобно считать на GPU.',
            sliders: [
                { key: 'w0', label: 'b', min: -5, max: 5, step: 0.1 },
                { key: 'w1', label: 'w[0]', min: -5, max: 5, step: 0.1 },
                { key: 'w2', label: 'w[1]', min: -5, max: 5, step: 0.1 }
            ]
        }
    };

    // --- Core Functions ---
    function setMode(modeKey) {
        state.mode = modeKey;
        
        // Update Tabs
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        // Find button by onclick text content (simple match)
        const buttons = document.getElementsByClassName('tab-btn');
        for (let btn of buttons) {
            if (btn.getAttribute('onclick').includes(modeKey)) {
                btn.classList.add('active');
            }
        }

        renderSidebarContent();
        updatePlot();
    }

    function renderSidebarContent() {
        const config = modes[state.mode];
        
        // Update Formula & Desc
        document.getElementById('zFormulaContainer').innerHTML = config.formula;
        document.getElementById('descContainer').innerHTML = config.desc;

        // Render Sliders
        const container = document.getElementById('sliders-container');
        container.innerHTML = '';

        config.sliders.forEach(slider => {
            const group = document.createElement('div');
            group.className = 'control-group';
            
            const label = document.createElement('label');
            label.innerHTML = `<span>${slider.label}</span> <span class="value-badge" id="val-${slider.key}">${state[slider.key].toFixed(1)}</span>`;
            
            const input = document.createElement('input');
            input.type = 'range';
            input.min = slider.min;
            input.max = slider.max;
            input.step = slider.step;
            input.value = state[slider.key];
            
            input.oninput = (e) => {
                state[slider.key] = parseFloat(e.target.value);
                document.getElementById(`val-${slider.key}`).textContent = state[slider.key].toFixed(1);
                updatePlot();
            };

            group.appendChild(label);
            group.appendChild(input);
            container.appendChild(group);
        });

        // MathJax
        if (window.MathJax) {
            MathJax.typesetPromise([document.querySelector('.sidebar')]);
        }
    }

    function sigmoid(z) {
        return 1 / (1 + Math.exp(-z));
    }

    function calculateZ(x) {
        let z = state.w0 + state.w1 * x;
        // For modes with multiple weights, add w2 effect (x2 fixed at 1.0 for visualization)
        if (state.mode === 'stats' || state.mode === 'ml' || state.mode === 'linalg') {
            z += state.w2 * 1.0;
        }
        return z;
    }

    function updatePlot() {
        const xValues = [];
        const yValues = [];
        
        const xMin = -10;
        const xMax = 10;

        for (let x = xMin; x <= xMax; x += 0.1) {
            xValues.push(x);
            yValues.push(sigmoid(calculateZ(x)));
        }

        // Current Point
        const currentZ = calculateZ(state.xPoint);
        const currentProb = sigmoid(currentZ);

        // Update Text Displays
        document.getElementById('zValDisplay').textContent = currentZ.toFixed(2);
        document.getElementById('sigmaValDisplay').textContent = currentProb.toFixed(3);
        document.getElementById('probDisplay').textContent = (currentProb * 100).toFixed(1) + '%';
        
        // Color for point based on probability
        const pointColor = currentProb > 0.5 ? '#27ae60' : '#e74c3c'; // Green or Red

        const curveTrace = {
            x: xValues,
            y: yValues,
            mode: 'lines',
            line: { color: '#667eea', width: 4 },
            name: 'Sigmoid'
        };

        const pointTrace = {
            x: [state.xPoint],
            y: [currentProb],
            mode: 'markers',
            marker: { 
                color: pointColor, 
                size: 16, 
                line: { color: 'white', width: 3 } 
            },
            name: 'Current Input',
            showlegend: false
        };

        // Decision Boundary Line (where y=0.5)
        const boundaryTrace = {
            x: [xMin, xMax],
            y: [0.5, 0.5],
            mode: 'lines',
            line: { color: '#bdc3c7', width: 2, dash: 'dash' },
            hoverinfo: 'skip',
            showlegend: false
        };

        const layout = {
            margin: { t: 20, r: 20, b: 40, l: 50 },
            xaxis: { 
                title: 'Input Value (x)', 
                gridcolor: '#f1f3f5',
                range: [xMin, xMax]
            },
            yaxis: { 
                title: 'Probability $\sigma(z)$', 
                range: [-0.05, 1.05], 
                gridcolor: '#f1f3f5' 
            },
            showlegend: false,
            plot_bgcolor: 'white',
            paper_bgcolor: 'white',
            shapes: [
                {
                    type: 'line',
                    x0: state.xPoint, y0: 0,
                    x1: state.xPoint, y1: currentProb,
                    line: { color: pointColor, width: 1, dash: 'dot' }
                },
                {
                    type: 'line',
                    x0: xMin, y0: currentProb,
                    x1: state.xPoint, y1: currentProb,
                    line: { color: pointColor, width: 1, dash: 'dot' }
                }
            ]
        };

        const config = { responsive: true, displayModeBar: false };

        Plotly.react('sigmoidPlot', [boundaryTrace, curveTrace, pointTrace], layout, config);
    }

    // --- Init ---
    window.addEventListener('load', () => {
        setMode('school');
        
        // Setup X-Point Slider Listener (static one)
        document.getElementById('xPointSlider').addEventListener('input', (e) => {
            state.xPoint = parseFloat(e.target.value);
            document.getElementById('val-xPoint').textContent = state.xPoint.toFixed(1);
            updatePlot();
        });
    });

    window.addEventListener('resize', () => {
        Plotly.Plots.resize('sigmoidPlot');
    });

</script>
</body>
</html>