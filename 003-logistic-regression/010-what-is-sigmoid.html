<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What is Sigmoid? - Logistic Regression Interactive | How LLM Works</title>
    <meta name="description" content="Interactive visualization of the Sigmoid function in Logistic Regression. See how parameters shape the probability curve.">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --bg-color: #fafafa;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
            --accent-color: #667eea;
            --weight-color: #667eea;
            --input-color: #e67e22;
            --secondary-color: #7f8c8d;
            --border-radius: 12px;
            --shadow: 0 4px 20px rgba(0,0,0,0.06);
            --font-main: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 380px 1fr;
            height: 100vh;
        }

        .sidebar {
            background: var(--card-bg);
            padding: 25px;
            box-shadow: 4px 0 20px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
            z-index: 10;
        }

        h1 {
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0 0 5px 0;
            color: var(--text-color);
        }

        .subtitle {
            font-size: 0.9rem;
            color: var(--secondary-color);
            margin: 0 0 15px 0;
            line-height: 1.4;
        }

        /* Formula Box */
        .stat-box {
            background: #ecf0f1;
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            border-left: 4px solid var(--accent-color);
        }

        .main-formula {
            font-size: 1.3rem;
            margin-bottom: 15px;
        }

        /* Z Formula Switcher */
        .z-formula-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #ccc;
        }

        .arrow-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            color: #999;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .arrow-btn:hover {
            background: #ddd;
            color: #666;
        }

        .z-formula {
            font-size: 1.1rem;
            min-width: 200px;
        }

        .notation-label {
            font-size: 0.7rem;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
        }

        /* Controls */
        .control-panel {
            background: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 20px;
            border: 1px solid #eee;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .control-group label {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }

        .value-badge {
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-family: monospace;
        }

        input[type="range"] {
            width: 100%;
            cursor: pointer;
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            background: #ddd;
            border-radius: 3px;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent-color);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent-color);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        input[type="range"]::-moz-range-track {
            background: #ddd;
            height: 6px;
            border-radius: 3px;
        }

        /* Weight sliders (blue) */
        input[type="range"].weight-slider::-webkit-slider-thumb {
            background: var(--weight-color);
        }
        input[type="range"].weight-slider::-moz-range-thumb {
            background: var(--weight-color);
        }

        /* Input sliders (orange) */
        input[type="range"].input-slider::-webkit-slider-thumb {
            background: var(--input-color);
        }
        input[type="range"].input-slider::-moz-range-thumb {
            background: var(--input-color);
        }

        /* Content Area */
        .content {
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 30px;
            overflow-y: auto;
            background-color: #f0f2f5;
        }

        .viz-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            flex-shrink: 0;
        }

        .card-header {
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #2c3e50;
        }

        #sigmoidPlot {
            width: 100%;
            height: 450px;
        }

        .formula-bar {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 15px 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            flex-shrink: 0;
        }

        #calcDisplay {
            font-size: 1.1rem;
        }

        .explanation-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            flex-shrink: 0;
        }

        .info-card {
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .info-card h3 {
            margin-top: 0;
            font-size: 1rem;
            color: var(--accent-color);
        }

        .info-card p {
            font-size: 0.9rem;
            line-height: 1.6;
            color: #555;
        }

        /* Mobile Responsive */
        @media (max-width: 900px) {
            .main-layout { grid-template-columns: 1fr; grid-template-rows: auto 1fr; }
            .sidebar { height: auto; max-height: 45vh; }
            .content { padding: 15px; gap: 15px; }
            .explanation-grid { grid-template-columns: 1fr; }
            .formula-bar {
                flex-direction: column;
                align-items: flex-start;
                padding: 12px 15px;
            }
            #calcDisplay { font-size: 0.95rem; }
        }
    </style>
</head>
<body>

<div class="main-layout">
    <!-- Sidebar -->
    <div class="sidebar">
        <div>
            <h1>Logistic Regression</h1>
            <div class="subtitle">Understanding the Sigmoid Function</div>
        </div>

        <!-- Formula Display -->
        <div class="stat-box">
            <div class="main-formula">
                $$ \sigma(z) = \frac{1}{1 + e^{-z}} $$
            </div>
            <div class="z-formula-container">
                <button class="arrow-btn" onclick="prevNotation()">◀</button>
                <div>
                    <div id="zFormula" class="z-formula">$$ z = \beta_0 + \beta_1 x $$</div>
                    <div id="notationLabel" class="notation-label">School</div>
                </div>
                <button class="arrow-btn" onclick="nextNotation()">▶</button>
            </div>
        </div>

        <!-- Controls -->
        <div class="control-panel">
            <!-- Weight Sliders -->
            <div class="control-group">
                <label>
                    <span style="color: var(--weight-color); font-weight: 600;">β₀ (intercept)</span>
                    <span class="value-badge" style="background: var(--weight-color);" id="val-w0">0.0</span>
                </label>
                <input type="range" class="weight-slider" id="w0Slider" min="-10" max="10" step="0.1" value="0">
            </div>

            <div class="control-group">
                <label>
                    <span style="color: var(--weight-color); font-weight: 600;">β₁ (slope)</span>
                    <span class="value-badge" style="background: var(--weight-color);" id="val-w1">1.0</span>
                </label>
                <input type="range" class="weight-slider" id="w1Slider" min="-5" max="5" step="0.1" value="1">
            </div>

            <!-- Input Slider -->
            <div class="control-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
                <label>
                    <span style="color: var(--input-color); font-weight: 600;">x (input)</span>
                    <span class="value-badge" style="background: var(--input-color);" id="val-x">0.0</span>
                </label>
                <input type="range" class="input-slider" id="xSlider" min="-10" max="10" step="0.1" value="0">
            </div>
        </div>

        <div style="font-size: 0.8rem; color: #999; line-height: 1.5;">
            <strong>Tip:</strong> Use ◀ ▶ arrows above to see equivalent notations for z. The formula stays the same, just different letters!
        </div>
    </div>

    <!-- Main Content -->
    <div class="content">
        <!-- Formula Bar -->
        <div class="formula-bar">
            <div id="calcDisplay"></div>
            <div style="font-family: monospace; color: var(--accent-color); font-weight: bold; font-size: 1.1rem;">
                P(y=1) = <span id="probDisplay">50.0%</span>
            </div>
        </div>

        <!-- Visualization -->
        <div class="viz-card">
            <div id="sigmoidPlot"></div>
        </div>

        <!-- Explanations -->
        <div class="explanation-grid">
            <div class="info-card">
                <h3>Why Sigmoid?</h3>
                <p>
                    Linear lines ($z$) go from $-\infty$ to $+\infty$. This is bad for probabilities.
                    The Sigmoid function "squashes" any number into <strong>[0, 1]</strong>.
                </p>
            </div>
            <div class="info-card">
                <h3>Decision Boundary</h3>
                <p>
                    When $z = 0$, probability is exactly 50%.<br>
                    $z > 0$ → Class 1 &nbsp;|&nbsp; $z < 0$ → Class 0
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    // --- State ---
    const state = {
        w0: 0,      // β₀ (intercept)
        w1: 1,      // β₁ (slope)
        x: 0,       // input value
        notation: 0 // current notation index
    };

    // --- Notation variants (just display, same math) ---
    const notations = [
        { label: 'School', formula: '$$ z = \\beta_0 + \\beta_1 x $$' },
        { label: 'Stats', formula: '$$ z = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\dots $$' },
        { label: 'ML / NN', formula: '$$ z = w_1 x_1 + w_2 x_2 + \\dots + w_p x_p + b $$' },
        { label: 'Linear Algebra', formula: '$$ z = X\\mathbf{w} + b $$' }
    ];

    function nextNotation() {
        state.notation = (state.notation + 1) % notations.length;
        updateNotationDisplay();
    }

    function prevNotation() {
        state.notation = (state.notation - 1 + notations.length) % notations.length;
        updateNotationDisplay();
    }

    function updateNotationDisplay() {
        const n = notations[state.notation];
        document.getElementById('zFormula').innerHTML = n.formula;
        document.getElementById('notationLabel').textContent = n.label;
        if (window.MathJax) {
            MathJax.typesetPromise([document.getElementById('zFormula')]);
        }
    }

    // --- Core Functions ---
    function sigmoid(z) {
        return 1 / (1 + Math.exp(-z));
    }

    function calculateZ(x) {
        return state.w0 + state.w1 * x;
    }

    function getCalcHTML(x, z, prob) {
        const fmtNum = (n) => n < 0 ? `(${n.toFixed(1)})` : n.toFixed(1);

        const w0 = state.w0.toFixed(1);
        const w1 = state.w1.toFixed(1);
        const xVal = fmtNum(x);
        const zVal = z.toFixed(2);
        const expVal = Math.exp(-z).toFixed(2);
        const probVal = prob.toFixed(3);

        // Full calculation with sigma expansion
        return `$$ z = {\\color{#667eea}${w0}} + {\\color{#667eea}${w1}} \\cdot {\\color{#e67e22}${xVal}} = ${zVal} \\;\\;\\rightarrow\\;\\; \\sigma(z) = \\frac{1}{1 + e^{-${zVal}}} = \\frac{1}{1 + ${expVal}} = ${probVal} $$`;
    }

    function updatePlot() {
        const xValues = [];
        const yValues = [];
        const xMin = -10, xMax = 10;

        for (let x = xMin; x <= xMax; x += 0.1) {
            xValues.push(x);
            yValues.push(sigmoid(calculateZ(x)));
        }

        const currentZ = calculateZ(state.x);
        const currentProb = sigmoid(currentZ);

        // Update displays
        document.getElementById('calcDisplay').innerHTML = getCalcHTML(state.x, currentZ, currentProb);
        document.getElementById('probDisplay').textContent = (currentProb * 100).toFixed(1) + '%';

        // Re-render MathJax
        if (window.MathJax && window.MathJax.typesetPromise) {
            MathJax.typesetPromise([document.getElementById('calcDisplay')]).catch(err => console.log('MathJax error:', err));
        }

        const pointColor = currentProb > 0.5 ? '#27ae60' : '#e74c3c';

        const curveTrace = {
            x: xValues,
            y: yValues,
            mode: 'lines',
            line: { color: '#667eea', width: 4 },
            name: 'Sigmoid'
        };

        const pointTrace = {
            x: [state.x],
            y: [currentProb],
            mode: 'markers',
            marker: {
                color: pointColor,
                size: 16,
                line: { color: 'white', width: 3 }
            },
            name: 'Current Input',
            showlegend: false,
            hovertemplate: '<b>x = %{x:.2f}</b><br>P(y=1) = %{y:.3f}<br><i>Drag me!</i><extra></extra>'
        };

        const boundaryTrace = {
            x: [xMin, xMax],
            y: [0.5, 0.5],
            mode: 'lines',
            line: { color: '#bdc3c7', width: 2, dash: 'dash' },
            hoverinfo: 'skip',
            showlegend: false
        };

        const layout = {
            margin: { t: 20, r: 20, b: 40, l: 50 },
            xaxis: {
                title: 'Input Value (x)',
                gridcolor: '#f1f3f5',
                range: [xMin, xMax],
                fixedrange: true
            },
            yaxis: {
                title: 'Probability σ(z)',
                range: [-0.05, 1.05],
                gridcolor: '#f1f3f5',
                fixedrange: true
            },
            showlegend: false,
            dragmode: false,
            plot_bgcolor: 'white',
            paper_bgcolor: 'white',
            shapes: [
                {
                    type: 'line',
                    x0: state.x, y0: 0,
                    x1: state.x, y1: currentProb,
                    line: { color: pointColor, width: 1, dash: 'dot' }
                },
                {
                    type: 'line',
                    x0: xMin, y0: currentProb,
                    x1: state.x, y1: currentProb,
                    line: { color: pointColor, width: 1, dash: 'dot' }
                }
            ]
        };

        Plotly.react('sigmoidPlot', [boundaryTrace, curveTrace, pointTrace], layout, {
            responsive: true,
            displayModeBar: false,
            scrollZoom: false,
            doubleClick: false
        });
    }

    // --- Drag & Drop ---
    let isDragging = false;

    function setupDragHandlers() {
        const plotDiv = document.getElementById('sigmoidPlot');

        plotDiv.addEventListener('mousedown', (e) => {
            const rect = plotDiv.getBoundingClientRect();
            const xaxis = plotDiv._fullLayout.xaxis;
            const yaxis = plotDiv._fullLayout.yaxis;

            const xPx = e.clientX - rect.left;
            const yPx = e.clientY - rect.top;
            const xData = xaxis.p2d(xPx - xaxis._offset);
            const yData = yaxis.p2d(yPx - yaxis._offset);

            const currentY = sigmoid(calculateZ(state.x));
            if (Math.abs(xData - state.x) < 0.8 && Math.abs(yData - currentY) < 0.08) {
                isDragging = true;
                plotDiv.style.cursor = 'grabbing';
                e.preventDefault();
            }
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            const plotDiv = document.getElementById('sigmoidPlot');
            const rect = plotDiv.getBoundingClientRect();
            const xaxis = plotDiv._fullLayout.xaxis;
            const xPx = e.clientX - rect.left;
            let xData = xaxis.p2d(xPx - xaxis._offset);
            xData = Math.max(-10, Math.min(10, xData));

            state.x = xData;
            document.getElementById('xSlider').value = xData;
            document.getElementById('val-x').textContent = xData.toFixed(1);
            updatePlot();
        });

        document.addEventListener('mouseup', () => {
            if (isDragging) {
                isDragging = false;
                document.getElementById('sigmoidPlot').style.cursor = '';
            }
        });

        // Touch support
        plotDiv.addEventListener('touchstart', (e) => {
            const touch = e.touches[0];
            const rect = plotDiv.getBoundingClientRect();
            const xaxis = plotDiv._fullLayout.xaxis;
            const yaxis = plotDiv._fullLayout.yaxis;

            const xPx = touch.clientX - rect.left;
            const yPx = touch.clientY - rect.top;
            const xData = xaxis.p2d(xPx - xaxis._offset);
            const yData = yaxis.p2d(yPx - yaxis._offset);

            const currentY = sigmoid(calculateZ(state.x));
            if (Math.abs(xData - state.x) < 1.2 && Math.abs(yData - currentY) < 0.12) {
                isDragging = true;
                e.preventDefault();
            }
        }, { passive: false });

        plotDiv.addEventListener('touchmove', (e) => {
            if (!isDragging) return;
            e.preventDefault();
            const touch = e.touches[0];
            const rect = plotDiv.getBoundingClientRect();
            const xaxis = plotDiv._fullLayout.xaxis;
            const xPx = touch.clientX - rect.left;
            let xData = xaxis.p2d(xPx - xaxis._offset);
            xData = Math.max(-10, Math.min(10, xData));

            state.x = xData;
            document.getElementById('xSlider').value = xData;
            document.getElementById('val-x').textContent = xData.toFixed(1);
            updatePlot();
        }, { passive: false });

        plotDiv.addEventListener('touchend', () => { isDragging = false; });

        // Click on curve
        plotDiv.on('plotly_click', (data) => {
            if (isDragging) return;
            const xData = data.points[0].x;
            if (typeof xData === 'number') {
                state.x = Math.max(-10, Math.min(10, xData));
                document.getElementById('xSlider').value = state.x;
                document.getElementById('val-x').textContent = state.x.toFixed(1);
                updatePlot();
            }
        });

        plotDiv.on('plotly_hover', (data) => {
            if (data.points[0].curveNumber === 2) plotDiv.style.cursor = 'grab';
        });

        plotDiv.on('plotly_unhover', () => {
            if (!isDragging) plotDiv.style.cursor = '';
        });
    }

    // --- Slider Listeners ---
    function setupSliders() {
        document.getElementById('w0Slider').addEventListener('input', (e) => {
            state.w0 = parseFloat(e.target.value);
            document.getElementById('val-w0').textContent = state.w0.toFixed(1);
            updatePlot();
        });

        document.getElementById('w1Slider').addEventListener('input', (e) => {
            state.w1 = parseFloat(e.target.value);
            document.getElementById('val-w1').textContent = state.w1.toFixed(1);
            updatePlot();
        });

        document.getElementById('xSlider').addEventListener('input', (e) => {
            state.x = parseFloat(e.target.value);
            document.getElementById('val-x').textContent = state.x.toFixed(1);
            updatePlot();
        });
    }

    // --- Init ---
    window.addEventListener('load', () => {
        setupSliders();
        updatePlot();
        setTimeout(setupDragHandlers, 100);
    });

    window.addEventListener('resize', () => {
        Plotly.Plots.resize('sigmoidPlot');
    });
</script>
</body>
</html>
